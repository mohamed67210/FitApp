{% extends 'base.html.twig' %}

{% block title %}Detail de{% endblock %}
{% block body %}
    <main class="main_user">
        {% for message in app.flashes('message') %}
        <div class="notification">
        <p>{{ message }}</p>
        <span class="notification_progress"></span>
        </div>
        {% endfor %}
    
    <header class="user_header">
        <div class="user_image">
            <img src="{{ asset('assets/images/user/'~ user.image ~'') }}" alt="photo-user">
        </div>
        <div class="nav">
            <ul>
                {# nav pour coach profil #}
                {% if user.roles.0 == "ROLE_COACH"  %}
                <li><button class="infos_btn">Infos</button></li>
                <li><button class="btn_popup" href="">Diplomes</button></li>
                {# <li><button>Editer</button></li> #}
                {% endif %}
                {# nav pour membre profil #}
                {% if user.roles.0 == "ROLE_USER"  %}
                <li><button class="infos_btn">infos</button></li>
                <li><button >Favories</button></li>
                {# <li><button href="">Editer</button></li> #}
                {% endif %}
            </ul>
        </div>
    </header>
    <section class="user_body">
        <div class="user_body_content">
            {# -------------------------------------profile coach #}
            {% if user.roles.0 == "ROLE_COACH" %}
            {# --------------------------------------affichage des programmes creer #}
                {% for programme in user.programsCreated %}
                    <div class="programme_cart">
                        {% if app.user == user %}
                        <div class="btn_panel">
                            <a href="{{ path('programme_modules',{'id': programme.id}) }}"><i class="fa-solid fa-list"></i></a>
                            <a href="{{ path('edit_programme',{'id': programme.id}) }}"><i
                                    class="fa-solid fa-pen-to-square"></i></a>
                            <a href="{{ path('delete_programme',{'id': programme.id}) }}"><i class="fa-solid fa-trash"></i></a>
                        </div>
                        {% endif %}

                        <div class="programme_image">
                            <img src="{{ asset('assets/images/programmes/'~ programme.image ~'') }}"
                                alt="{{programme.intitule}}">
                        </div>
                        <div class="programme_contenu">
                            <h5>{{programme.intitule|upper}}</h5>
                            <p>{{programme.description}}</p>
                            {% if programme.prixPromo is defined and programme.prixPromo is not null %}
                            <span class="prix"><del>{{programme.prix|striptags|number_format(2, ',', '.')}} €</del></span>
                            <span class="prix">{{programme.prixPromo|striptags|number_format(2, ',', '.')}} €</span>
                            {% else %}
                            <span class="prix">{{programme.prix|number_format(2, ',', '.')}} €</span>
                            {% endif %}
                        </div>
                        <a href="{{path('show_programme',{'id':programme.id})}}" class="btn_achat">Voir detail</a>
                    </div>
                {% endfor %}
                {# ----------------------------------------------affichage de diplomes #}
                <div class="diplomes_popup">
                    <div class="popup_content">
                    <div>
                        <h2>mes diplomes</h2><i id="diplome_form_btn" class="fa-solid fa-plus"></i>
                    </div>
                        <ul>
                        {% for diplome in user.diplomes %}
                            <li>
                                {{diplome}}{% if diplome.isVerified == true %}
                                <i class="fa-solid fa-square-check" style="color: #467326;"></i>
                                {% endif %}
                            </li>
                        {% endfor %}
                        </ul>
                        {# ---------------------------------- formulaire d'ajout diplome #}
                    {% if formDiplome is defined %}
                        <div id="diplome_form">
                            {{form_start (formDiplome)}}
                            {{form_end (formDiplome)}}
                        </div>
                    {% endif %}
                    <button id="popup_close" class="diplomes_popup_close">fermer</button>
                    </div>
                </div>
            {% endif %}
            {# -------------------------affichage infos user #}
            <div id="infos_popup">
                <div class="popup_content">
                <div>
                    <h2>mes infos</h2>
                    <a href="{{ path('edit_user',{'id':user.id}) }}"><i id="diplome_form_btn" class="fa-solid fa-user-pen"></i></a>
                </div>
                <ul>
                    <li><h4>nom : {{user.nom}}</h4></li>
                    <li><h4>nom : {{user.prenom}}</h4></li>
                    <li><h4>nom : {{user.email}}</h4></li>
                </ul>
                    
                    <button id="popup_close" class="infos_popup_close">fermer</button>
                </div>
            </div>
        </div>
    </section>
    </main>
{% endblock body %}